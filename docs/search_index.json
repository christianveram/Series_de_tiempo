[["index.html", "Temperatura histórica en la ciudad de Bogotá. Capítulo: 1 Introducción", " Temperatura histórica en la ciudad de Bogotá. Christian Vera, Yuli Deaquiz y Juan Rodríguez 12/04/2025 Capítulo: 1 Introducción La base de datos de Meteostat es una fuente robusta y accesible de información meteorológica histórica, que abarca variables como temperatura, precipitación, humedad, presión atmosférica y velocidad del viento, recopiladas desde estaciones meteorológicas distribuidas a nivel global. Esta plataforma es una herramienta importante para la investigación climática y ambiental, tiene cobertura temporal desde inicios del siglo XX y tiene actualización continua con datos diarios y horarios. Además, esta base de datos integra fuentes oficiales como servicios meteorológicos nacionales, redes de observación internacionales y datos satelitales, lo cual garantiza un alto nivel de confiabilidad y precisión en la generación de modelos predictivos y generación de escenarios de cambio climático[1]. Por lo que, el análisis y pronóstico de datos meteorológicos es una herramienta clave para diversos sectores productivos y sociales, al permitir anticipar condiciones ambientales que impactan directamente en la operación, sostenibilidad y toma de decisiones[2]. Un ejemplo de ello se da en el sector agrícola, donde el uso de datos meteorológicos permite optimizar épocas de siembra, uso adecuado del agua y zonas aptas para el establecimiento de cultivos. De acuerdo con [3], el cambio climático afecta el rendimiento agrícola, por lo que integrar esta información a los sistemas de decisión puede mejorar la producción. Asimismo, [4] muestran cómo los modelos de predicción basados en datos meteorológicos mejoran la precisión del pronóstico de rendimiento de cultivos, permitiendo una planificación más eficiente. En el ámbito urbano, el análisis climático apoya la planificación de infraestructuras y ciudades más adaptadas al calentamiento global. Estudios han demostrado que las proyecciones meteorológicas, combinadas con datos históricos, permiten modelar el impacto y mejorar el diseño urbano para enfrentar eventos extremos [5]. Ciudades que integran esta información pueden reducir su vulnerabilidad ante olas de calor, inundaciones o aumentos en la demanda energética. Desde la perspectiva energética, el pronóstico meteorológico es crucial para integrar fuentes renovables como la energía solar y eólica en los sistemas eléctricos modernos. La generación de energía renovable depende en gran medida de condiciones climáticas, por lo que prever estas variaciones permite una mejor gestión de la oferta y la demanda energética. Según [6], la precisión en el pronóstico del clima mejora la operación de redes inteligentes y reduce los costos de almacenamiento y distribución de energía. En el campo de la salud pública y el cambio climático, los registros meteorológicos históricos son fundamentales para estudiar la relación entre condiciones ambientales y enfermedades [7]. Es por esto que, el análisis y pronóstico del clima permite anticipar y gestionar los efectos del clima en la agricultura, las ciudades, la energía y la salud. El aprovechamiento de estos datos es esencial no solo para la eficiencia operativa, sino también para la construcción de sociedades más resilientes y sostenibles frente al cambio climático global [8]. Finalmente, para este estudio, se analizarán los datos de temperatura media proporcionados por el IDEAM, correspondientes a la estación meteorológica 80222 de la Organización Meteorológica Mundial (WMO), ubicada en el Aeropuerto Internacional El Dorado (SKBO) en Bogotá. Estos datos fueron extraídos mediante la API gratuita de Meteostat en Python. Esta estación representa una fuente confiable y de alta calidad para el monitoreo climático a nivel local, ya que cuenta con registros continuos que permiten complementar el análisis histórico y el modelado climático, proporcionando una perspectiva más precisa del contexto urbano. Referencias [1] Meteostat Project, “Meteostat documentation: Historical weather and climate data.” https://dev.meteostat.net/, 2024. [2] C. Boisvenue and S. W. Running, “Simulated impacts of climate change on forest growth and timber supply in canada,” Climatic Change, vol. 161, pp. 381–395, 2020, doi: 10.1007/s10584-020-02671-1. [3] M. Zampieri, A. Ceglar, F. Dentener, and A. Toreti, “Wheat yield loss attributable to heat waves, drought and water excess at the global, national and subnational scales,” Environmental Research Letters, vol. 16, no. 3, p. 034063, 2021, doi: 10.1088/1748-9326/abd8b2. [4] S. Khaki, L. Wang, and S. V. Archontoulis, “A CNN-RNN framework for crop yield prediction,” Frontiers in Artificial Intelligence, vol. 3, p. 36, 2020, doi: 10.3389/frai.2020.00036. [5] C. Johansson, S. Thorsson, and F. Lindberg, “Urban design and thermal comfort in a changing climate: A case study from sweden,” Urban Climate, vol. 38, p. 100882, 2021, doi: 10.1016/j.uclim.2021.100882. [6] M. Wytock, J. Z. Kolter, and Y. Chen, “Weather-driven predictive modeling for energy systems,” Renewable and Sustainable Energy Reviews, vol. 135, p. 110220, 2021, doi: 10.1016/j.rser.2020.110220. [7] N. Watts et al., “The 2022 report of the lancet countdown on health and climate change: Health at the mercy of fossil fuels,” The Lancet, vol. 400, no. 10363, pp. 1619–1654, 2022, doi: 10.1016/S0140-6736(22)01540-9. [8] IPCC, “Climate change 2021: The physical science basis. Contribution of working group i to the sixth assessment report of the intergovernmental panel on climate change.” Cambridge University Press, 2021. Available: https://www.ipcc.ch/report/ar6/wg1/ "],["medias-móviles-rezagos-y-descomposición-de-la-serie-temporal.html", "Capítulo: 2 Medias Móviles, Rezagos y Descomposición de la Serie Temporal 2.1 Promedios móviles (SMA de 7 y 30 días) 2.2 Rezagos (lags de 1, 7 y 30 días) 2.3 Descomposición STL.", " Capítulo: 2 Medias Móviles, Rezagos y Descomposición de la Serie Temporal Christian Vera, Yuli Deaquiz y Juan Rodríguez 26/04/2025 En primer lugar, se identifica la ventana temporal de las temperaturas registradas por este sensor, la cual comprende datos diarios desde el 1 de enero de 1975 hasta el 31 de marzo de 2025. No obstante, es importante señalar que el conjunto de datos incluye observaciones que se remontan hasta el año 1941, lo que proporciona una perspectiva histórica amplia. Sin embargo, diversos análisis indican que la calidad y confiabilidad de los registros mejora significativamente a partir de 1972, debido a que en los periodos anteriores se observa una alta frecuencia de valores atípicos y anomalías que podrían comprometer la precisión de cualquier análisis basado en dichas observaciones. Por esta razón, los datos previos a 1972 suelen utilizarse con precaución o ser excluidos de los estudios que requieren alta fiabilidad en las series temporales [9]. Teniendo en cuenta lo anterior, se realizaran distintos análisis temporales de la temperatura promedio de la ciudad de Bogotá. Para ello, se aplicarán técnicas de suavizamiento mediante el cálculo de promedios móviles, así como análisis de rezagos y de estacionalidad. Estas aproximaciones permitirán identificar y representar patrones, tendencias y ciclos a lo largo del tiempo. En primer lugar se carga y verifica el tipo de datos del conjunto de datos seleccionado, garantizando que la fecha esté en formato correcto. En el siguiente enlace se puede apreciar el proceso de extracción mediante las API de meteostat y Openmeteo en Python. Notebook de descarga de datos en GitHub Code library(knitr) library(kableExtra) url &lt;- &quot;https://raw.githubusercontent.com/christianveram/Series_de_tiempo/refs/heads/main/bases/temperaturas_final.csv&quot; datos &lt;- read.csv(url) datos$time &lt;- as.Date(datos$time) # Mostrar tipo datos datos %&gt;% select(time, tavg) %&gt;% summarise(across(everything(), ~class(.))) %&gt;% pivot_longer(everything(), names_to = &quot;Columna&quot;, values_to = &quot;Tipo de Dato&quot;) %&gt;% kable(format = &quot;html&quot;, align = &quot;c&quot;) %&gt;% kable_styling(full_width = F, position = &quot;center&quot;) Columna Tipo de Dato time Date tavg numeric 2.1 Promedios móviles (SMA de 7 y 30 días) El promedio móvil simple (SMA) es una técnica de suavizamiento que consiste en calcular el promedio de un número fijo de observaciones consecutivas. Sirve para reducir el “ruido” en los datos y destacar patrones como tendencias o ciclos, ayudando en el análisis visual de series de tiempo antes de aplicar modelos más complejos. Se calcularon dos promedios móviles simples (SMA) sobre la variable de temperatura promedio diaria (tavg), utilizando ventanas de 7 y 30 días respectivamente. Para ello, se aplicó la función rollmean, permitiendo un relleno de valores faltantes con NA presente el algunos días de la serie y alineando las medias móviles hacia la derecha. Luego, se construyó un gráfico de líneas que incluye la serie original de temperatura (en gris claro) y las dos curvas suavizadas correspondientes a los promedios móviles (en azul acero para 7 días y rojo oscuro para 30 días). Esta gráfica permite observar la evolución suavizada de la temperatura a lo largo del tiempo, eliminando la variabilidad diaria que puede ocultar patrones generales. El promedio móvil de 7 días capta fluctuaciones semanales, mientras que el de 30 días refleja tendencias de más largo plazo. Al observar esta última, se evidencia una tendencia ascendente en la temperatura promedio, especialmente notable en las últimas décadas. Code library(tidyr) library(dplyr) library(ggplot2) # Cálculo de medias móviles datos_filtrados &lt;- datos_filtrados %&gt;% mutate( sma_7 = rollmean(tavg, k = 7, fill = NA, align = &quot;right&quot;), sma_30 = rollmean(tavg, k = 30, fill = NA, align = &quot;right&quot;)) # gráfica con ggplot grafica &lt;- ggplot(datos_filtrados, aes(x = fecha)) + geom_line(aes(y = tavg, color = &quot;Temperatura Promedio&quot;), size = 0.5) + geom_line(aes(y = sma_7, color = &quot;Media Móvil 7 Días&quot;), size = 0.5) + geom_line(aes(y = sma_30, color = &quot;Media Móvil 30 Días&quot;), size = 0.5) + labs(title = &quot;Temperatura promedio con medias móviles&quot;, x = &quot;Fecha&quot;, y = &quot;Temperatura promedio (°C)&quot;) + scale_color_manual(values = c(&quot;Temperatura Promedio&quot; = &quot;gray70&quot;, &quot;Media Móvil 7 Días&quot; = &quot;steelblue&quot;, &quot;Media Móvil 30 Días&quot; = &quot;darkred&quot;)) + theme_minimal() + theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) print(grafica) 2.2 Rezagos (lags de 1, 7 y 30 días) Un rezago (lag) en series de tiempo consiste en desplazar la serie hacia atrás en el tiempo para observar cómo los valores pasados afectan a los valores presentes o futuros. El análisis de los rezagos permite identificar autocorrelaciones, que son relaciones importantes para modelar y predecir series temporales. Se generaron tres nuevas variables de rezago (lag_1, lag_7 y lag_30), que corresponden a la temperatura promedio registrada hace 1, 7 y 30 días respectivamente. La gráfica ilustra la relación entre la temperatura de un día y la del día anterior. Una correlación positiva sugiere la existencia de dependencia temporal en la serie, es decir, que los valores actuales están influenciados por los valores pasados En este caso se observa una correlación positiva, lo que indica que la temperatura actual tiende a ser más alta cuando la temperatura en el pasado (ya sea hace 1, 7 o 30 días) también fue más alta. Sin embargo, la fuerza de esta correlación disminuye a medida que aumenta el lapso de tiempo, indicando que la temperatura de días más lejanos en el pasado tiene una menor capacidad predictiva sobre la temperatura del presente en comparación con la temperatura de días más recientes. Code library(tidyr) library(dplyr) library(ggplot2) # rezagos datos_filtrados &lt;- datos_filtrados %&gt;% mutate( lag_1 = lag(tavg, 1), lag_7 = lag(tavg, 7), lag_30 = lag(tavg, 30)) datos_filtrados_long &lt;- datos_filtrados %&gt;% gather(key = &quot;lag&quot;, value = &quot;lag_value&quot;, lag_1, lag_7, lag_30) %&gt;% mutate(lag = factor(lag, levels = c(&quot;lag_1&quot;, &quot;lag_7&quot;, &quot;lag_30&quot;))) # Crear la gráfica con ggplot usando facet_wrap grafica &lt;- ggplot(datos_filtrados_long, aes(x = lag_value, y = tavg)) + geom_point(alpha = 0.3, color = &quot;blue&quot;) + geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;black&quot;, size = 0.5) + # Línea más fina labs(title = &quot;Relación entre temperatura actual y rezago de diferentes días&quot;, x = &quot;Temperatura rezagada&quot;, y = &quot;Temperatura actual&quot;) + facet_wrap(~lag, scales = &quot;free&quot;) + # subgráfica para cada lag theme_minimal() + theme(plot.title = element_text(hjust = 0.5)) # Mostrar la gráfica print(grafica) 2.3 Descomposición STL. La descomposición STL (Seasonal and Trend decomposition using Loess) es una técnica que separa una serie de tiempo en componentes de tendencia, estacionalidad y ruido. Utiliza un enfoque basado en suavizamiento local, que permite capturar patrones no lineales y estacionalidades que pueden cambiar con el tiempo, ofreciendo una interpretación más detallada de la serie. Para analizar la estacionalidad y la tendencia de la serie, se imputaron valores faltantes de la variable tavg mediante interpolación lineal (na.approx). Luego, se transformó la serie en un objeto de tipo ts con frecuencia anual (365 observaciones por año). Se aplicó una descomposición STL (stl) que separa la serie en tendencia, estacionalidad y residuo. La descomposición STL permite visualizar cómo se estructura la variabilidad de la temperatura promedio en sus componentes principales. La tendencia muestra los cambios a largo plazo en la serie, la estacionalidad revela los patrones cíclicos asociados a las distintas épocas del año, y el residuo indica las fluctuaciones irregulares no explicadas. Este análisis es importante para entender los comportamientos recurrentes y para preparar adecuadamente los datos para modelos de pronóstico. En este caso se puede extraer lo siguiente: La tendencia muestra un aumento gradual de la temperatura a lo largo del tiempo, especialmente notable a partir de aproximadamente el año 2000. El componente estacional revela un patrón cíclico que se repite anualmente, lo que sugiere variaciones de temperatura relacionadas con las estaciones del año. El residuo representa las fluctuaciones irregulares que no se explican ni por la tendencia ni por la estacionalidad, indicando la presencia de variabilidad aleatoria o eventos inusuales en los datos de temperatura. Code # Cargar librerías necesarias library(plotly) library(zoo) library(ggplot2) library(lubridate) library(forecast) # Imputamos NA para asegurar continuidad datos_ts &lt;- ts(na.approx(datos_filtrados$tavg, na.rm = FALSE), frequency = 365, start = c(year(min(datos_filtrados$fecha)), yday(min(datos_filtrados$fecha)))) # Descomposición STL descomposicion &lt;- stl(datos_ts, s.window = &quot;periodic&quot;) # Convertir el gráfico ggplot a interactivo con plotly grafico_interactivo &lt;- autoplot(descomposicion) + labs( title = &quot;Descomposición de la serie de temperatura promedio&quot;, x = &quot;Fecha&quot;, y = &quot;Valor&quot; ) + theme_minimal(base_size = 14) + theme( plot.title = element_text(hjust = 0.5, face = &quot;bold&quot;, size = 12, color = &quot;black&quot;), # Cambié el color del título axis.title = element_text(size = 11, color = &quot;black&quot;), # Cambié el color de los títulos de los ejes strip.text = element_text(face = &quot;bold&quot;, size = 11, color = &quot;black&quot;), # Cambié el color del texto de las etiquetas panel.grid.minor = element_blank() ) + # Ajustar el grosor de las líneas y el color de la serie geom_line(size = 0.2, color = &quot;blue&quot;) # Convertir el gráfico ggplot a un gráfico interactivo ggplotly(grafico_interactivo) En conjunto, el uso de estas tres herramientas proporcionan una base para comprender la dinámica de la serie de tiempo. Esta aproximación no solo facilita la detección de ciclos estacionales y tendencias ocultas, sino que también es relevante para diseñar modelos predictivos más robustos. La correcta interpretación de estos componentes permite tomar decisiones mejor informadas en contextos relacionados con el análisis climático o la planificación de recursos Referencias [9] E. Aguilar et al., “Changes in precipitation and temperature extremes in central america and northern south america, 1961–2003,” Journal of Geophysical Research: Atmospheres, vol. 110, no. D23, 2005, doi: https://doi.org/10.1029/2005JD006119. "],["estacionariedad.html", "Capítulo: 3 Estacionariedad 3.1 Preprocesamiento y visualización. 3.2 Diferenciación", " Capítulo: 3 Estacionariedad 3.1 Preprocesamiento y visualización. Christian Vera, Yuli Deaquiz y Juan Rodríguez 04/05/2025 Una serie temporal estacionaria es aquella cuyas propiedades no dependen del momento en que se observa .Por lo tanto, las series temporales con tendencias o con estacionalidad no son estacionarias: la tendencia y la estacionalidad afectarán el valor de la serie temporal en diferentes momentos. Una serie temporal estacionaria no presenta patrones predecibles a largo plazo. Esto implica que si la serie es estacionaria, estaríamos prediciendo que las características estadísticas de nuestra serie de tiempo serán las mismas en el futuro como en el pasado. Para poder comprobar si la serie es estacionaria se puede utilizar algunos métodos estadísticos, entre los más utilizados se encuentran la prueba de Dickey-Fuller Aumentada (ADF) y la prueba de Kwiatkowski-Phillips-Schmidt-Shin (KPSS). Para nuestro caso usamos las dos pruebas como se muestran a continuación: Code library(knitr) library(kableExtra) library(tidyverse) library(lubridate) library(zoo) library(forecast) url &lt;- &quot;https://raw.githubusercontent.com/christianveram/Series_de_tiempo/refs/heads/main/bases/temperaturas_final.csv&quot; datos &lt;- read.csv(url) datos$time &lt;- as.Date(datos$time) datos_filtrados &lt;- datos %&gt;% mutate(fecha = as.Date(time)) %&gt;% arrange(fecha) %&gt;% filter(fecha &gt;= as.Date(&quot;1975-01-01&quot;)) # &#39;tavg&#39; a dos decimales datos_filtrados &lt;- datos_filtrados %&gt;% mutate(tavg = round(tavg, 2)) Prueba de Dickey-Fuller. Code # Prueba de Dickey-Fuller # Ho: La serie no presenta estacionariedad # Ha: La serie presenta estacionariedad ## Prueba de Dickey-Fuller # Ejecutar la prueba Dickey-Fuller library(tseries) library(knitr) library(kableExtra) # Ejecutar la prueba adf_result &lt;- adf.test(datos_filtrados$tavg) # Crear tabla de resultados adf_table &lt;- data.frame( &quot;Test Statistic&quot; = round(adf_result$statistic, 4), &quot;Lag Order&quot; = adf_result$parameter, &quot;p-value&quot; = round(adf_result$p.value, 4), &quot;Alternative&quot; = as.character(adf_result$alternative), check.names = FALSE ) # Mostrar tabla con kableExtra kable(adf_table, align = &quot;c&quot;) %&gt;% kable_styling( bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = FALSE, position = &quot;center&quot;) Test Statistic Lag Order p-value Alternative Dickey-Fuller -14.5464 26 0.01 stationary Con un p-valor de 0.01, se rechaza la hipótesis nula de no estacionariedad, lo que indica que la serie de la variable temperatura promedio es estacionaria. Esto implica que sus propiedades estadísticas, como la media y la varianza, se mantienen constantes en el tiempo y que la serie no presenta una tendencia sostenida. Prueba KPSS Code # Prueba KPSS # Ho: La serie es estacionaria # Ha: La serie no es estacionaria library(tseries) library(knitr) library(kableExtra) kpss_result &lt;- kpss.test(datos_filtrados$tavg) # Crear tabla de resultados kpss_table &lt;- data.frame( &quot;KPSS Statistic&quot; = round(kpss_result$statistic, 3), &quot;Truncation Lag Parameter&quot; = kpss_result$parameter, &quot;p-value&quot; = round(kpss_result$p.value, 4), check.names = FALSE ) # Mostrar tabla con numeración automática kable(kpss_table, align = &quot;c&quot;) %&gt;% kable_styling( bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = FALSE, position = &quot;center&quot; ) KPSS Statistic Truncation Lag Parameter p-value KPSS Level 34.079 14 0.01 El p-valor es 0.01. Dado que este valor es menor que el nivel de significancia de 0.05, se rechaza la hipótesis nula de estacionariedad. Esto indica que la serie temporal no es estacionaria en nivel, lo cual sugiere que presenta una tendencia sistemática a lo largo del tiempo, como un posible aumento progresivo en la temperatura promedio. Con base en los resultados de las pruebas realizadas, se puede concluir que la serie es estacionaria en diferencias, según el test ADF, pero no lo es en tendencia, según el test KPSS. Por lo tanto, se recomienda llevar a cabo el proceso de diferenciación para lograr la estacionariedad de la serie. 3.2 Diferenciación La diferenciación es una técnica utilizada en el análisis de series temporales para hacer que una serie no estacionaria se vuelva estacionaria. Esto se logra calculando las diferencias entre valores consecutivos de la serie temporal. Así mismo, ayuda a eliminar las tendencias en los datos, haciendo que la serie sea estacionaria. Además, facilita el Modelado ya que al hacer que la serie sea estacionaria, se facilita la aplicación de modelos de series temporales como ARIMA. Para la variable de temperatura promedio se aplicó una diferenciación de primer orden, la cual calcula la diferencia entre cada valor y el anterior en la serie temporal. Posteriormente se realizó nuevamente los test estadísticos de comprobación de la estacionariedad. Dickey-Fuller Test (Diferenciación) Code # Prueba de Dickey-Fuller # Ho: La serie no presenta estacionariedad # Ha: La serie presenta estacionariedad ## Prueba de Dickey-Fuller estacionariedad=diff(datos_filtrados$tavg) #adf.test(estacionariedad) # Ejecutar la prueba Dickey-Fuller library(tseries) library(knitr) library(kableExtra) # Ejecutar la prueba adf_result1 &lt;- adf.test(estacionariedad) # Crear tabla de resultados adf_table &lt;- data.frame( &quot;Test Statistic&quot; = round(adf_result1$statistic, 4), &quot;Lag Order&quot; = adf_result1$parameter, &quot;p-value&quot; = round(adf_result1$p.value, 4), &quot;Alternative&quot; = as.character(adf_result1$alternative), check.names = FALSE ) # Mostrar tabla kable(adf_table, align = &quot;c&quot;) %&gt;% kable_styling( bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = FALSE, position = &quot;center&quot;) Test Statistic Lag Order p-value Alternative Dickey-Fuller -40.1841 26 0.01 stationary En este caso el valor p de 0.01 indica que se puede rechazar la hipótesis nula de que la serie no es estacionaria, siendo menor al umbral de significancia 0.05. KPSS Test (Diferenciación). Code # Prueba KPSS # Ho: La serie es estacionaria # Ha: La serie no es estacionaria #kpss.test(estacionariedad) library(tseries) library(knitr) library(kableExtra) kpss_result2 &lt;- kpss.test(estacionariedad) # Crear tabla de resultados kpss_table &lt;- data.frame( &quot;KPSS Statistic&quot; = round(kpss_result2$statistic, 3), &quot;Truncation Lag Parameter&quot; = kpss_result2$parameter, &quot;p-value&quot; = round(kpss_result2$p.value, 4), check.names = FALSE) # Mostrar tabla kable(kpss_table, align = &quot;c&quot;) %&gt;% kable_styling( bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = FALSE, position = &quot;center&quot;) KPSS Statistic Truncation Lag Parameter p-value KPSS Level 0.001 14 0.1 En este caso, el test KPSS aplicado a la serie diferenciada da un valor p de 0.1, lo que sugiere que no hay suficiente evidencia para rechazar la hipótesis nula de estacionariedad en el nivel, indicando que la serie es estacionaria después de la diferenciación. En comparación con el test anterior, donde el valor p era 0.01, que indicaba que la serie no era estacionaria, esta diferencia sugiere que la diferenciación eliminó la tendencia y permitió que la serie se volviera estacionaria. Finalmente, se puede concluir en los dos test estadísticos con un nivel de confianza del 95% que la serie es estacionaria luego de aplicar la diferenciación. Code library(forecast) par(mfrow = c(2, 2), mar = c(5, 5, 3, 1)) # ACF para estacionariedad acf(estacionariedad, lag.max = 34, main = &quot;ACF - Serie diferenciada&quot;) # PACF para estacionariedad pacf(estacionariedad, lag.max = 34, main = &quot;PACF - Serie diferenciada&quot;) # ACF para datos_filtrados$tavg acf(datos_filtrados$tavg, lag.max = 34, main = &quot;ACF - Serie Original&quot;) # PACF para datos_filtrados$tavg pacf(datos_filtrados$tavg, lag.max = 34, main = &quot;PACF - Serie Original&quot;) Figura 3.1 Análisis de Autocorrelación (ACF y PACF) de la serie de temperatura promedio de la ciudad de Bogotá DC. A partir de la Figura 3.1 se puede extraer lo siguiente: ACF - Serie diferenciada: Presenta un pico negativo significativo en el Lag 1, lo que indica una autocorrelación negativa inmediata entre los valores consecutivos después de la diferenciación. Los rezagos posteriores se encuentran dentro de los límites de confianza, lo que sugiere ausencia de autocorrelación significativa en los siguientes periodos, lo cual es un indicativo de una serie estacionaria. PACF - Serie diferenciada: Muestra un pico negativo significativo en el Lag 1, mostrando una fuerte correlación parcial negativa con el primer rezago. Las barras de los rezagos posteriores se mantienen dentro de los límites de confianza, indicando que no hay efectos significativos más allá del primer rezago. Esto sugiere que la serie ha alcanzado estabilidad en sus propiedades estadísticas. ACF - Serie Original: Se observa una reducción lenta de las autocorrelaciones, con barras que permanecen fuera de los límites de confianza en varios rezagos, lo que indica una dependencia temporal y sugiere visualmente que la serie no es estacionaria. Sin embargo, los resultados del test ADF aplicado a la serie original indican que se puede considerar estacionaria desde el punto de vista estadístico PACF - Serie Original: Presenta un pico significativo en el Lag 1 (positivo), lo que indica una fuerte correlación parcial con el primer rezago. Aunque los valores disminuyen rápidamente, algunos rezagos posteriores muestran ligeras significancias, reforzando la idea de no estacionariedad en la serie original y sugiere la necesidad de aplicar una diferenciación para estabilizarla. En resumen, el análisis mostró que la serie de temperatura promedio en Bogotá no es estacionaria al inicio debido a una tendencia, pero al aplicar una diferenciación de primer orden se logra estabilizar. Esto es clave para poder aplicar modelos como ARIMA y hacer predicciones más precisas y confiables. "],["holt-winters..html", "Capítulo: 4 Holt-Winters. 4.1 Ajuste Holt-Winters. 4.2 Pronóstico Holt-Winters (12 meses) 4.3 Métricas de desempeño.", " Capítulo: 4 Holt-Winters. Christian Vera, Yuli Deaquiz y Juan Rodríguez 10/05/2025 El modelo de Holt-Winters, permite analizar series de tiempo univariantes que contienen factores de tendencia y/o estacionalidad, involucrando un enfoque de suavización exponencial con métodos analíticos y patrones aditivos y multiplicativos. Es un método mejorado para calcular pronósticos cuando los datos muestran una tendencia y además estacionalidad, por lo cual se incorporan 3 constantes, que son α y β, según la metodología de Holt el cual tiene encuenta el nivel de los datos y su tendencia, agregando además γ, el cual incluye la estacionalidad, cuyos valores también deben estar entre cero y la unidad. Para este ejercicio se dividio la base de datos en una base de entrenamiento y un test de prueba de la siguiente forma: Base de entrenamiento: del periodo de 1975 a 2021. Base de prueba: periodo de 2022 en adelante. Code # Cargar paquetes necesarios library(tidyverse) library(lubridate) library(forecast) library(kableExtra) # 1. Cargar y preparar los datos url &lt;- &quot;https://raw.githubusercontent.com/christianveram/Series_de_tiempo/refs/heads/main/bases/temperaturas_final.csv&quot; datos &lt;- read.csv(url) datos$time &lt;- as.Date(datos$time) datos_filtrados &lt;- datos %&gt;% mutate(fecha = as.Date(time), tavg = round(tavg, 2)) %&gt;% filter(fecha &gt;= as.Date(&quot;1975-01-01&quot;)) %&gt;% arrange(fecha) # 2. Agregar datos por mes (promedio mensual) datos_mensuales &lt;- datos_filtrados %&gt;% mutate(anio_mes = floor_date(fecha, &quot;month&quot;)) %&gt;% group_by(anio_mes) %&gt;% summarise(tavg = mean(tavg, na.rm = TRUE)) %&gt;% ungroup() # 3. Convertir a serie temporal ts_temp &lt;- ts(datos_mensuales$tavg, start = c(year(min(datos_mensuales$anio_mes)), month(min(datos_mensuales$anio_mes))), frequency = 12) # 4. Separar en conjunto de entrenamiento (hasta 2021) y prueba (desde 2022) ts_train &lt;- window(ts_temp, end = c(2021, 12)) ts_test &lt;- window(ts_temp, start = c(2022, 1)) # 5. Ajustar modelo Holt-Winters clásico modelo_hw &lt;- HoltWinters(ts_train) 4.1 Ajuste Holt-Winters. Code # 6. Graficar la serie completa con ajuste # Crear una serie para el ajuste de Holt-Winters ajuste_completo &lt;- ts(fitted(modelo_hw)[,1], start = start(ts_temp), frequency = 12) # Graficar la serie original con el ajuste plot(ts_temp, main = &quot;Serie completa con ajuste Holt-Winters&quot;, col = &quot;blue&quot;, lwd = 2, ylab = &quot;Temperatura&quot;, xlab = &quot;Tiempo&quot;) lines(ajuste_completo, col = &quot;red&quot;, lwd = 1.5) legend(&quot;topright&quot;, legend = c(&quot;Serie completa&quot;, &quot;Ajuste Holt-Winters&quot;), col = c(&quot;blue&quot;, &quot;red&quot;), lwd = 2) Figura 4.1. Serie temporal método Hold-Winters para la temperatura promedio de la ciudad Bogotá DC. Se puede observar en la figura 4.1 que el modelo Hold-Winters muestra un buen ajuste de la variable, ya que la linea roja (modelo de Hold-Winters) es cercana a la serie original (linea azul), sin embargo, no puede captar todas las fluctuaciones menores que puede asociarse a datos atipicos en algunos periodos de tiempo, que pueden estar asociados al fenómeno del niño y la niña. Además, este modelo esta diseñado para capturar patrones de tendencia y regularidad que pueden verse influenciados en este caso por fenomenos climáticos. 4.2 Pronóstico Holt-Winters (12 meses) Code # 7. Pronosticar 36 meses pronostico &lt;- forecast(modelo_hw, h = 12) # 8. Graficar el pronóstico plot(pronostico, main = &quot;Pronóstico Holt-Winters (12 meses)&quot;, xlab = &quot;Tiempo&quot;, ylab = &quot;Temperatura&quot;) Figura 4.2. Pronóstico Holt-Winter para la temperatura promedio de la ciudad de Bogotá DC. En la figura 4.2 se observa con una confiabilidad del 95% representada en las lineas grises, que la temperatura promedio oscilará entre 14 a 15 °C para los siguientes 12 meses entre 2022-1 a 2022-12, sobre los cuales se realizó la evaluación del modelo. 4.3 Métricas de desempeño. Code # 9. Calcular métricas de evaluación sobre el conjunto de prueba metricas &lt;- accuracy(pronostico, ts_test) metricas_df &lt;- as.data.frame(metricas)[2, c(&quot;ME&quot;, &quot;RMSE&quot;, &quot;MAE&quot;, &quot;MAPE&quot;)] # Convertir a data frame con nombres descriptivos metricas_df &lt;- data.frame( Métrica = c(&quot;Error Medio (ME)&quot;, &quot;Raíz del Error Cuadrático Medio (RMSE)&quot;, &quot;Error Absoluto Medio (MAE)&quot;, &quot;Error Porcentual Absoluto Medio (MAPE)&quot;), Valor = unlist(metricas_df) ) # 10. Mostrar tabla con el mismo estilo que adf_table kable(metricas_df, align = &quot;c&quot;, row.names = FALSE) %&gt;% kable_styling( bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;), full_width = FALSE, position = &quot;center&quot; ) Métrica Valor Error Medio (ME) -0.7712311 Raíz del Error Cuadrático Medio (RMSE) 0.8424277 Error Absoluto Medio (MAE) 0.7712311 Error Porcentual Absoluto Medio (MAPE) 5.7011795 En relación a la tabla anterior, que reporta las métricas del modelo se puede inferir: Error Medio: con un valor de -0.77 indica que el modelo subestima la temperatura en -0.77°C. Raíz del Cudratíco medio de los errores: con un valor 0.84, esto significa que, en promedio, la desviación de las predicciones del modelo respecto a los valores reales es aproximadamente 0.84 unidades. Un RMSE más bajo indica un mejor ajuste del modelo a los datos, ya que sugiere que los errores de predicción son menores. Error Absoluto Medio: Esto significa que, en promedio, las predicciones del modelo se desvían de los valores reales en aproximadamente 0.77 unidades. A diferencia del RMSE, el MAE no eleva al cuadrado las diferencias, lo que significa que no es tan sensible a los valores atípicos. Error Porcentual Absoluto medio: En terminos relativo las predicciones del modelo estan un 5.7% por encima o por debajo del valor real. Se puede concluir que la predicción a partir del método Holt-Winter tiene un desempeño adecuado para la variable de temperatura promedio, aunque es suceptible de mejoras para reducir el sesgo y minimizar los errores. "],["referencias.html", "Referencias", " Referencias [1] Meteostat Project, “Meteostat documentation: Historical weather and climate data.” https://dev.meteostat.net/, 2024. [2] C. Boisvenue and S. W. Running, “Simulated impacts of climate change on forest growth and timber supply in canada,” Climatic Change, vol. 161, pp. 381–395, 2020, doi: 10.1007/s10584-020-02671-1. [3] M. Zampieri, A. Ceglar, F. Dentener, and A. Toreti, “Wheat yield loss attributable to heat waves, drought and water excess at the global, national and subnational scales,” Environmental Research Letters, vol. 16, no. 3, p. 034063, 2021, doi: 10.1088/1748-9326/abd8b2. [4] S. Khaki, L. Wang, and S. V. Archontoulis, “A CNN-RNN framework for crop yield prediction,” Frontiers in Artificial Intelligence, vol. 3, p. 36, 2020, doi: 10.3389/frai.2020.00036. [5] C. Johansson, S. Thorsson, and F. Lindberg, “Urban design and thermal comfort in a changing climate: A case study from sweden,” Urban Climate, vol. 38, p. 100882, 2021, doi: 10.1016/j.uclim.2021.100882. [6] M. Wytock, J. Z. Kolter, and Y. Chen, “Weather-driven predictive modeling for energy systems,” Renewable and Sustainable Energy Reviews, vol. 135, p. 110220, 2021, doi: 10.1016/j.rser.2020.110220. [7] N. Watts et al., “The 2022 report of the lancet countdown on health and climate change: Health at the mercy of fossil fuels,” The Lancet, vol. 400, no. 10363, pp. 1619–1654, 2022, doi: 10.1016/S0140-6736(22)01540-9. [8] IPCC, “Climate change 2021: The physical science basis. Contribution of working group i to the sixth assessment report of the intergovernmental panel on climate change.” Cambridge University Press, 2021. Available: https://www.ipcc.ch/report/ar6/wg1/ [9] E. Aguilar et al., “Changes in precipitation and temperature extremes in central america and northern south america, 1961–2003,” Journal of Geophysical Research: Atmospheres, vol. 110, no. D23, 2005, doi: https://doi.org/10.1029/2005JD006119. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
